{"version":3,"sources":["libs/mobilebone.js"],"names":["root","factory","document","MBLOADED","define","amd","cmd","exports","Mobilebone","store","slice","isSimple","isWebkit","documentElement","style","webkitHidden","supportHistory","history","support","hasInited","VERSION","captureLink","captureForm","rootTransition","mergeCallback","classAnimation","classPage","classMask","pushStateEnabled","evalScript","window","navigator","userAgent","indexOf","top","popstate","transition","pageInto","pageOut","back","options","arguments","length","isNaN","defaults","form","onpagefirstinto","animationstart","animationend","preventdefault","fallback","callback","params","element","getAttribute","_params","_dataparams","_queryToObject","forEach","key","getFunction","local_function_key","apply","paramsOut","paramsIn","classList","preventOut","isPreventOut","preventInto","isPreventInto","call","funAnimationCall","page","data","flagAniBind","animationkey","index","animition","webkitkey","replace","matchs","toUpperCase","animateEventName","addEventListener","contains","display","remove","add","offsetWidth","removeSelf","title","header","querySelector","firstPage","innerHTML","setAttribute","pageid","id","hashid","firstintoBind","querySelectorAll","submit","urlPush","urlPushReplace","test","location","hash","setTimeout","domOrId","elePage","tagName","toLowerCase","getCleanUrl","parentElement","removeChild","trigger","url","href","formdata","cleanUrl","nodeType","action","method","$","fn","serialize","control","name","disabled","val","value","trim","type","checked","push","strContainer","attrContainer","queryContainer","arrData","keyValue","encodeURIComponent","join","split","createPage","domHtml","eleOrObj","response","container","isreload","optionsTransition","titlePage","idContainer","classPageInside","getElementById","target","reload","eleCurrentPage","eleCreatePage","create","createElement","appendChild","getElementsByTagName","originScript","scriptContent","src","head","script","createTextNode","insertBefore","firstChild","eleCreateTitle","className","innerText","Date","now","query","body","keys","fun","arrKey","ajax","aOrFormOrObj","attrMask","dataType","timeout","async","username","password","success","error","complete","eleMask","formData","paramsFromTrigger","queryFromUrl","FormData","key2","children","filter","showLoading","xhr","XMLHttpRequest","open","onload","status","JSON","parse","jsonHandle","e","message","hideLoading","onerror","ontimeout","setRequestHeader","send","event","attrPrevent","funPrevent","preventDefault","isBack","pageIn","tempBack","compareDocumentPosition","json","init","eleIn","jQuery","Zepto","tap","handleTapEvent","getParentElementByTag","isSafari7","match","hidden","chrome","popstateswipe","touches","selfPage","getElementsByClassName","capture","rel","external","attrHref","hashTargetPage","idTargetPage","queryTargetPage","eleTargetPage","attrReload","ele","Element","prototype","tag","parent","popup","tagParent","string","obj","part","arrPart"],"mappings":"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","file":"mobilebone.f4f719ce.js","sourceRoot":"..","sourcesContent":["/*\n * mobilebone.js\n * by zhangxinxu(.com) 2014-09-26\n * https://github.com/zhangxinxu/mobilebone\n * bone of switch for mobile web app\n**/\n\n(function(root, factory) {\n\tif (document.MBLOADED) { return; }\n\t// Set up Mobilebone appropriately for the environment.\n\tif (typeof define === \"function\" && (define.amd || define.cmd)) {\n\t\tdefine(\"mobilebone\", function(exports) {\n\t\t\treturn factory(root, exports);\n\t\t});\n\t// Finally, as a browser global.\n\t} else {\n\t\troot.Mobilebone = factory(root, {});\n\t}\n})(this, function(root, Mobilebone) {\n\tif (document.MBLOADED) {\n\t\treturn \"Don\\'t repeat load Mobilebone!\";\n\t}\n\n\t// Avoid repeated callbacks\n\tvar store = {};\n\n\t// Create local references to array methods we'll want to use later.\n\tvar array = [];\n\tvar slice = array.slice;\n\n\t// Is it a id selector\n\tvar isSimple = /^#?\\w+(?:[\\-_]\\w+)*$/i;\n\n\t// Is it webkit\n\tvar isWebkit = \"WebkitAppearance\" in document.documentElement.style || typeof document.webkitHidden != \"undefined\";\n\n\t// Is it suppory history API\n\tvar supportHistory = \"pushState\" in history && \"replaceState\" in history;\n\n\tMobilebone.support = supportHistory;\n\n\tvar hasInited = false;\n\n\t/**\n\t * Current version of the library. Keep in sync with `package.json`.\n\t *\n\t * @type string\n\t**/\n\tMobilebone.VERSION = \"2.7.4\";\n\n\t/**\n\t * Whether catch attribute of href from element with tag 'a'\n\t * If the value set to false, jump links in a refresh form(not slide)\n\t * In most cases, you do not need to care about this parameter.\n\t   Except some special pages that should refresh all links, as test/index.html show.\n\t   However, if your only want several links refesh, you can use data-ajax=\"false\" or data-rel=\"external\"\n\t *\n\t * @type boolean\n\t**/\n\tMobilebone.captureLink = true;\n\n\t/**\n\t * Whether catch events of 'submit' from <form> element\n\t * If the value set to false, <form> is a normal form except data-ajax=\"true\"\n\t * If the value set to true, <form> will submit as a ajax request,\n\t   and the return value will be used to create a new page and transition into meanwhile.\n\t   However, if data-ajax=\"false\", <form> won't submit as a ajax.\n\t *\n\t * @type boolean\n\t**/\n\tMobilebone.captureForm = true;\n\n\t/**\n\t * The root of transition-callback\n\t * Default value is 'root', you can consider as window-object.\n\t   However, there are may many callbacks, it's impossible that all functions are global function.\n\t   We may custom a global object to store our callbacks, such as:\n\t   Callback = {\n\t\t fun1: function() {},\n\t\t fun2: function() {},\n\t\t fun3: function() {},\n\t   }\n\t   In this case, the value of 'obilebone.rootTransition' should set Callback;\n\t *\n\t * @type object\n\t**/\n\tMobilebone.rootTransition = root;\n\n\t/**\n\t * Whether merge(vs cover) global callback and local callback\n\t *\n\t * @type boolean\n\t**/\n\tMobilebone.mergeCallback = true;\n\n\t/**\n\t *  className of animation\n\t *\n\t * @type string\n\t**/\n\tMobilebone.classAnimation = \"slide\";\n\t/**\n\t *  for mark page element\n\t *\n\t * @type string\n\t**/\n\tMobilebone.classPage = \"page\";\n\t/**\n\t * className for mark mask element\n\t *\n\t * @type string\n\t**/\n\tMobilebone.classMask = \"mask\";\n\t/**\n\t * Whether url changes when history changes\n\t * If this value is false, the url will be no change.\n\t *\n\t * @type boolean\n\t**/\n\tMobilebone.pushStateEnabled = true;\n\t/**\n\t * Whether excute JavaScript when ajax HTML loaded\n\t * If this value is true, the script will excute.\n\t *\n\t * @type boolean\n\t**/\n\tMobilebone.evalScript = false;\n\n\tif (// When running inside a FF iframe, calling replaceState causes an error. So set 'pushStateEnabled = false'\n\t\t(window.navigator.userAgent.indexOf( \"Firefox\" ) >= 0 && window.top !== window)\n\t) {\n\t\tMobilebone.pushStateEnabled = false;\n\t}\n\n\t/**\n\t * if browser do not support history/classList, stop here\n\t**/\n\tif (supportHistory == false) {\n\t\treturn Mobilebone;\n\t}\n\n\t/**\n\t * don't excute window.onpopstate when page load\n\t**/\n\thistory.popstate = false;\n\n\t/**\n\t * Function for transition\n\t * In most cases, you are unnecessary to use this function , unlike Mobilebone.createPage\n\n\t * @params  pageInto: dom-object. Element which will transform into. - Necessary\n\t            pageOut:  dom-object. Element which will transform out.   - Optional\n\t\t\t    back:     boolean.    Direction of transition.          - Optional\n\t\t\t    options:  object.     Cover or add parameters.           - Optional\n\t * @returns undefined\n\t * @example Mobilebone.transition(element);\n\t            Mobilebone.transition(element1, element2);\n\t\t        Mobilebone.transition(element1, element2, true);\n\t\t        Mobilebone.transition(element1, element2, { id: \"only\" });\n\t\t        Mobilebone.transition(element1, element2, true, { id: \"only\" });\n\t**/\n\tMobilebone.transition = function(pageInto, pageOut, back, options) {\n\t\tif (arguments.length == 0 || pageInto == pageOut) return;\n\t\tif (arguments.length == 3 && isNaN(back * 1) == true) {\n\t\t\toptions = back;\n\t\t\tback = options.back;\n\t\t};\n\n\t\t//if those parameters is missing\n\t\tpageOut = pageOut || null, back = back || false, options = options || {};\n\n\t\t// defaults parameters\n\t\tvar defaults = {\n\t\t\t// the value of callback is a key name, and the host is root here.\n\t\t\t// eg. if the name of animationstart is 'doLoading', so the script will execute 'root.doLoading()'\n\t\t\t// By default, the value of root is 'window'\n\t\t\troot: this.rootTransition,\n\t\t\t// the form of transition, the value (eg. 'slide') will be a className to add or remove.\n\t\t\t// of course, u can set to other valeu, for example, 'fade' or 'flip'. However, u shou add corresponding CSS3 code.\n\t\t\tform: this.form || this.classAnimation,\n\t\t\t// 'animationstart/animationend/...' are callbacks params\n\t\t\t// Note: those all global callbacks!\n\t\t\tonpagefirstinto: this.onpagefirstinto,\n\t\t\tanimationstart: this.animationstart,\n\t\t\tanimationend: this.animationend,\n\t\t\tpreventdefault: this.preventdefault,\n\t\t\tfallback: this.fallback,\n\t\t\tcallback: this.callback\n\t\t}, params = function(element) {\n\t\t\tif (!element || !element.getAttribute) return {};\n\n\t\t\tvar _params = {}, _dataparams = _queryToObject(element.getAttribute(\"data-params\") || \"\");\n\n\t\t\t// rules as follow:\n\t\t\t// data-* > data-params > options > defaults\n\t\t\t[\"title\", \"root\", \"form\"].forEach(function(key) {\n\t\t\t\t_params[key] = element.getAttribute(\"data-\" + key) || _dataparams[key] || options[key] || defaults[key];\n\t\t\t});\n\n\t\t\tif (typeof _params.root == \"string\") {\n\t\t\t\t_params.root = Mobilebone.getFunction(_params.root);\n\t\t\t}\n\n\t\t\t[\"onpagefirstinto\", \"callback\", \"fallback\", \"animationstart\", \"animationend\", \"preventdefault\"].forEach(function(key) {\n\t\t\t\tif (Mobilebone.mergeCallback == true && typeof defaults[key] == \"function\") {\n\t\t\t\t\t// merge global callback\n\t\t\t\t\tvar local_function_key = element.getAttribute(\"data-\" + key) || _dataparams[key];\n\t\t\t\t\tif (typeof _params.root[local_function_key] == \"function\") {\n\t\t\t\t\t\t_params[key] = function() {\n\t\t\t\t\t\t\tdefaults[key].apply(this, arguments);\n\t\t\t\t\t\t\t_params.root[local_function_key].apply(this, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (typeof options[key] == \"function\") {\n\t\t\t\t\t\t_params[key] = function() {\n\t\t\t\t\t\t\tdefaults[key].apply(this, arguments);\n\t\t\t\t\t\t\toptions[key].apply(this, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_params[key] = defaults[key];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// replace global callback\n\t\t\t\t\t_params[key] = element.getAttribute(\"data-\" + key) || _dataparams[key] || options[key] || defaults[key];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn _params;\n\t\t};\n\n\t\t// get params of each\n\t\tvar paramsOut = params(pageOut), paramsIn = params(pageInto);\n\n\t\tif (pageOut != null && pageOut.classList) {\n\t\t\t// weather prevent transition\n\t\t\tvar preventOut = paramsOut.preventdefault, isPreventOut = false;\n\t\t\tif (typeof preventOut == \"string\") {\n\t\t\t\tpreventOut = paramsOut.root[preventOut];\n\t\t\t}\n\t\t}\n\t\tif (pageInto != null && pageInto.classList) {\n\t\t\t// weather prevent transition\n\t\t\tvar preventInto = paramsIn.preventdefault, isPreventInto = false;\n\t\t\tif (typeof preventInto == \"string\") {\n\t\t\t\tpreventInto = paramsIn.root[preventInto];\n\t\t\t}\n\t\t}\n\t\tif (typeof preventOut == \"function\") {\n\t\t\tisPreventOut = preventOut.call(paramsOut.root, pageInto, pageOut, options);\n\t\t}\n\n\t\t// if functions of 'preventdefault' are same for pageIn and pageout, just excute once.\n\t\tif (isPreventOut == true && preventOut === preventInto) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof preventInto == \"function\") {\n\t\t\tisPreventInto = preventInto.call(paramsIn.root, pageInto, pageOut, options);\n\t\t}\n\t\t// if pageinto stopped, stop all\n\t\tif (isPreventInto == true) {\n\t\t\t// only run here and nothing more\n\t\t\treturn false;\n\t\t}\n\n\t\t// set animation callback as a method\n\t\tvar funAnimationCall = function(page, data) {\n\t\t\tif (page.flagAniBind == true) return;\n\t\t\t// do callback when animation start/end\n\t\t\t[\"animationstart\", \"animationend\"].forEach(function(animationkey, index) {\n\t\t\t\tvar animition = paramsIn[animationkey], webkitkey = \"webkit\" + animationkey.replace(/^a|s|e/g, function(matchs) {\n\t\t\t\t\treturn matchs.toUpperCase();\n\t\t\t\t});\n\t\t\t\tvar animateEventName = isWebkit? webkitkey: animationkey;\n\t\t\t\t// if it's the out element, hide it when 'animationend'\n\t\t\t\tif (index) {\n\t\t\t\t\tpage.addEventListener(animateEventName, function() {\n\t\t\t\t\t\tif (this.classList.contains(\"in\") == false) {\n\t\t\t\t\t\t\tthis.style.display = \"none\";\n\t\t\t\t\t\t\t// add on v2.5.5\n\t\t\t\t\t\t\t// move here on v2.5.8\n\t\t\t\t\t\t\t// main for remove page is just current page\n\t\t\t\t\t\t\t// remove on v2.7.0\n\t\t\t\t\t\t\t// if (this.removeSelf == true) {\n\t\t\t\t\t\t\t// \tthis.parentElement.removeChild(this);\n\t\t\t\t\t\t\t// \tthis.removeSelf = null;\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.classList.remove(params(this).form);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// bind animation events\n\t\t\t\tif (typeof animition == \"string\" && paramsIn.root[animition]) {\n\t\t\t\t\tpage.addEventListener(animateEventName, function() {\n\t\t\t\t\t\tdata.root[animition].call(data.root, this, this.classList.contains(\"in\")? \"into\": \"out\", options);\n\t\t\t\t\t});\n\t\t\t\t} else if (typeof animition == \"function\") {\n\t\t\t\t\tpage.addEventListener(animateEventName, function() {\n\t\t\t\t\t\tanimition.call(data.root, this, this.classList.contains(\"in\")? \"into\": \"out\", options);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// set a flag\n\t\t\t\tpage.flagAniBind = true;\n\t\t\t});\n\t\t};\n\n\t\tif (pageOut != null && pageOut.classList) {\n\t\t\t// do transition if there are no 'prevent'\n\t\t\tif (isPreventOut != true) {\n\t\t\t\tpageOut.classList.add(paramsOut.form);\n\t\t\t\t// reflow\n\t\t\t\tpageOut.offsetWidth = pageOut.offsetWidth;\n\t\t\t\t// go, go, go\n\t\t\t\tpageOut.style.display = \"block\";\n\t\t\t\tpageOut.classList.add(\"out\");\n\t\t\t\tpageOut.classList.remove(\"in\");\n\t\t\t\t// if reverse direction\n\t\t\t\tpageOut.classList[back? \"add\": \"remove\"](\"reverse\");\n\n\t\t\t\t// add on v2.5.5\n\t\t\t\tpageOut.removeSelf = pageOut.removeSelf || null;\n\n\t\t\t\t// set animation callback for 'pageInto'\n\t\t\t\t// for issues #153\n\t\t\t\tfunAnimationCall(pageOut, paramsOut);\n\n\t\t\t\t// do fallback every time\n\t\t\t\tvar fallback = paramsOut.fallback;\n\t\t\t\tif (typeof fallback == \"string\") {\n\t\t\t\t\tfallback = paramsOut.root[fallback];\n\t\t\t\t}\n\t\t\t\tif (typeof fallback == \"function\") {\n\t\t\t\t\tfallback.call(paramsOut.root, pageInto, pageOut, options);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (pageInto != null && pageInto.classList) {\n\t\t\t// for title change\n\t\t\tvar title = paramsIn.title,\n\t\t\t    header = document.querySelector(\"h1\"),\n\t\t\t    firstPage = document.querySelector(\".\" + this.classPage);\n\n\t\t\t// do title change\n\t\t\tif (title && options.title !== false) {\n\t\t\t\tdocument.title = title;\n\t\t\t\tif (header) {\n\t\t\t\t\theader.innerHTML = title;\n\t\t\t\t\theader.title = title;\n\t\t\t\t}\n\t\t\t} else if (firstPage == pageInto && !pageOut && document.title) {\n\t\t\t\t// set data-title for first visibie page\n\t\t\t\tpageInto.setAttribute(\"data-title\", document.title);\n\t\t\t}\n\n\t\t\t// delete page with same id when options.remove !== false\n\t\t\tvar pageid = options.id || pageInto.id;\n\t\t\tvar hashid = options.id || pageInto.id;\n\n\t\t\t// v2.7.0 change rule -> don't auto delete pages\n\t\t\t//                    -> delete by using Mobilebone.remove();\n\t\t\t// v2.7.2 add using data-reload=\"xxxxId\" to auto remove pages\n\t\t\t// Reason Two:\n\t\t\t// 1. Most websites are so simple that it's not enough to talk about performance;\n\t\t\t// 2. We can't judge relation by two page's url\n\t\t\t\t// eg, below 'if' sentence only cover sence 0:\n\t\t\t\t/*\n\t\t\t\tif (options.id) {\n\t\t\t\t\t// eg. get 'ajax.php' from 'ajax.php?xx=1'\n\t\t\t\t \tpageid = pageid.split(\"?\")[0];\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t\t// 0. url format: //xxx.com/list.php\n\t\t\t\t                  //xxx.com/detail.php?id=1\n\t\t\t\t                  //xxx.com/detail.php?id=2\n\n\t\t\t\t// but not sence 1 and 2:\n\n\t\t\t\t// 1. url format: //xxx.com/list/111/\n\t\t\t\t                  //xxx.com/list/222/\n\t\t\t\t                  //xxx.com/list/333/\n\t\t\t\t                  // 明明需要删除的，没删除\n\n\t            // 2. url format: //xxx.com/index.php   列表页\n\t                              //xxx.com/index.php?list=1   列表详情页1\n\t                              //xxx.com/index.php?list=2   列表详情页2\n\t                              // 以上列表页就嗝屁了\n\n\t\t\t// var relid = store[\"_\" + pageid];\n\t\t\t// // only delete page auto when data-reload is not 'false' or null\n\t\t\t// // hashid may store the same page, we should delete also\n\t\t\t// // when data-reload not 'false' or null\n\t\t\t// // v2.4.4+\n\t\t\t// if (relid && store[relid] && options.reload == true) {\n\t\t\t// \tdelete store[relid];\n\t\t\t// \tdelete store[\"_\" + pageid];\n\t\t\t// }\n\n\t\t\t// // below commented on v2.6.2\n\t\t\t// if (options.reload == true) {\n\t\t\t// \t// v2.5.8 for issues #147\n\t\t\t// \tpageInto.removeSelf = true;\n\t\t\t// }\n\n\t\t\t// if (store[pageid] && store[pageid] != pageInto) {\n\n\n\t\t\t// \tif (store[pageid] != pageOut) {\n\t\t\t// \t\tstore[pageid].parentElement && store[pageid].parentElement.removeChild(store[pageid]);\n\t\t\t// \t} else {\n\t\t\t// \t\t// if the page element same as store\n\t\t\t// \t\t// remove when animationend\n\t\t\t// \t\tpageOut.removeSelf = true;\n\t\t\t// \t}\n\t\t\t// \tdelete store[pageid];\n\t\t\t// }\n\n\t\t\t// do transition\n\t\t\tif (pageOut) {\n\t\t\t\tpageInto.classList.add(paramsIn.form);\n\t\t\t}\n\t\t\t// iOS bug\n\t\t\t// reflow for fixing issues #80, #86\n\t\t\tpageInto.offsetWidth = pageInto.offsetWidth;\n\t\t\t// go~ as normal\n\t\t\tpageInto.style.display = \"block\";\n\t\t\tpageInto.classList.remove(\"out\");\n\t\t\tpageInto.classList.add(\"in\");\n\t\t\t// if reverse direction\n\t\t\tpageInto.classList[back? \"add\": \"remove\"](\"reverse\");\n\n\t\t\t// do callback when come in first time\n\t\t\tvar onpagefirstinto = paramsIn.onpagefirstinto;\n\t\t\t// first judge change to pageInto store\n\t\t\t// v2.5.5 add for fix issues #138\n\t\t\tif (!pageInto.firstintoBind) {\n\t\t\t\tif (typeof onpagefirstinto == \"string\" && paramsIn.root[onpagefirstinto]) {\n\t\t\t\t\tparamsIn.root[onpagefirstinto].call(paramsIn.root, pageInto, pageOut, options);\n\t\t\t\t} else if (typeof onpagefirstinto == \"function\") {\n\t\t\t\t\tonpagefirstinto.call(paramsIn.root, pageInto, pageOut, options);\n\t\t\t\t}\n\t\t\t\t// capture form submit\n\t\t\t\tslice.call(pageInto.querySelectorAll(\"form\")).forEach(function(form) {\n\t\t\t\t\tMobilebone.submit(form);\n\t\t\t\t});\n\n\t\t\t\tpageInto.firstintoBind = true;\n\t\t\t}\n\n\t\t\t// set animation callback for 'pageInto'\n\t\t\tfunAnimationCall(pageInto, paramsIn);\n\n\t\t\t// history\n\t\t\t// hashid should a full url address\n\t\t\t// different with pageid\n\t\t\t// add on 2.4.2\n\t\t\tvar urlPush = hashid, urlPushReplace = \"\";\n\n\t\t\tif (urlPush && /^#/.test(urlPush) == false) {\n\t\t\t\turlPush = \"#\" + urlPush;\n\t\t\t}\n\t\t\turlPushReplace = urlPush.replace(/^#/, \"#&\");\n\n\t\t\tif (supportHistory && this.pushStateEnabled && options.history !== false && urlPush\n\t\t\t\t// hash should be different\n\t\t\t\t// can fix issues #79, #87 maybe\n\t\t\t\t&& urlPushReplace != location.hash\n\t\t\t) {\n\t\t\t\t// don't trigger 'popstate' events\n\t\t\t\thistory.popstate = false;\n\t\t\t\t// if only pageIn, use 'replaceState'\n\t\t\t\thistory[pageOut? \"pushState\": \"replaceState\"](null, document.title, urlPush.replace(/^#/, \"#&\"));\n\t\t\t}\n\n\t\t\t// store page-id, just once\n\t\t\tif (!store[pageid]) {\n\t\t\t\tstore[pageid] = pageInto;\n\t\t\t\t// when we back/prev, we need to get true\n\t\t\t\t// comment on v2.7.0\n\t\t\t\t// if (hashid !== pageid) {\n\t\t\t\t// \tstore[hashid] = pageInto;\n\t\t\t\t// \tstore[\"_\" + pageid] = hashid;\n\t\t\t\t// }\n\t\t\t}\n\n\t\t\t// do callback every time\n\t\t\tvar callback = paramsIn.callback;\n\n\t\t\tif (typeof callback == \"string\") {\n\t\t\t\tcallback = paramsIn.root[callback];\n\t\t\t}\n\t\t\tif (typeof callback == \"function\") {\n\t\t\t\tcallback.call(paramsIn.root, pageInto, pageOut, options);\n\t\t\t}\n\n\t\t\t// Safari do 'popstate' after 'pushState/replaceState'\n\t\t\t// So, we neet setTimeout to avoid excuting 'Mobilebone.transition()' twice\n\t\t\tsetTimeout(function() {\n\t\t\t\t// reset to popable state\n\t\t\t\thistory.popstate = true;\n\t\t\t}, 17);\n\t\t}\n\t};\n\n\t/**\n\t * Remove page DOM add on v2.7.0\n\t * @param  domOrId: dom-object|string\n\t *          page DOM or <a> DOM\n\t *          page id or <a> href value\n\t * @return {[type]}         [description]\n\t */\n\tMobilebone.remove = function (domOrId) {\n\t\tif (!domOrId) {\n\t\t\treturn this;\n\t\t}\n\n\t\tvar elePage = domOrId;\n\t\tvar pageid = domOrId;\n\t\tif (typeof pageid == \"string\") {\n\t\t\telePage = store[pageid];\n\t\t} else if (elePage.tagName && elePage.tagName.toLowerCase() == \"a\") {\n\t\t\tpageid = this.getCleanUrl(elePage);\n\t\t\telePage = store[pageid];\n\t\t}\n\n\t\tif (elePage && elePage.parentElement) {\n\t\t\telePage.parentElement.removeChild(elePage);\n\t\t\t// remove store\n\t\t\tfor (var key in store) {\n\t\t\t\tif (store[key] == elePage) {\n\t\t\t\t\tdelete store[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\n\t/**\n\t * For getting whole ajax url\n\t * In most cases, you are unnecessary to use this function\n\n\t * @params  trigger: dom-object. element with tag-\"a\".  - Optional(at least one)\n\t            url:     string. ajax url.                  - Optional(at least one)\n\t\t\t    params:  string|object. ajax params.        - Optional\n\t * @returns string\n\t * @example Mobilebone.getCleanUrl(elementOfA);\n\t            Mobilebone.getCleanUrl(elementOfForm);\n\t            Mobilebone.getCleanUrl(elementOfA, '', \"a=1&b=2\");\n\t\t        Mobilebone.getCleanUrl(null, \"xxx.html\");\n\t\t        Mobilebone.getCleanUrl(null, \"xxx.html?a=1&b=2\");\n\t\t        Mobilebone.getCleanUrl(null, \"xxx.html\", \"a=1&b=2\");\n\t**/\n\tMobilebone.getCleanUrl = function(trigger, url, params) {\n\t\tvar href = \"\", formdata = \"\", cleanUrl = \"\";\n\t\tif (trigger) {\n\t\t\t if (trigger.nodeType == 1) {\n\t\t\t\t // form element\n\t\t\t\t if (trigger.action) {\n\t\t\t\t\t href = trigger.getAttribute(\"action\");\n\t\t\t\t\t // add on v2.4.1\n\t\t\t\t\t if (trigger.method && trigger.method.toUpperCase() == \"POST\") {\n\t\t\t\t\t\t return href;\n\t\t\t\t\t } else if (window.$ && $.fn && $.fn.serialize) {\n\t\t\t\t\t\t// use jquery serialize()\n\t\t\t\t\t\tformdata = $(trigger).serialize();\n\t\t\t\t\t } else {\n\t\t\t\t\t\tformdata = {};\n\t\t\t\t\t\t// simple serialize from Mobilebone\n\t\t\t\t\t\tslice.call(trigger.querySelectorAll(\"input,select,textarea\")).forEach(function(control) {\n\t\t\t\t\t\t\tif (control.name && !control.disabled) {\n\t\t\t\t\t\t\t\tvar val = control.value.trim(), name = control.name;\n\t\t\t\t\t\t\t\tif (/^radio|checkbox/i.test(control.type)) {\n\t\t\t\t\t\t\t\t\tif (control.checked) {\n\t\t\t\t\t\t\t\t\t\tif (formdata[name]) {\n\t\t\t\t\t\t\t\t\t\t\tformdata[name].push(val);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tformdata[name] = [val];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tformdata[name] = [val];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t }\n\t\t\t\t } else {\n\t\t\t\t\t// a element\n\t\t\t\t\thref = trigger.getAttribute(\"href\");\n\t\t\t\t\tformdata = trigger.getAttribute(\"data-formdata\") || trigger.getAttribute(\"data-data\") || \"\";\n\t\t\t\t\t// v2.6.1 for #107\n\t\t\t\t\t// remember container when refresh\n\t\t\t\t\tvar strContainer = \"container\", attrContainer = trigger.getAttribute(\"data-\" + strContainer);\n\t\t\t\t\tif (formdata.indexOf(strContainer) == -1 && attrContainer) {\n\t\t\t\t\t\tvar queryContainer = strContainer + \"=\" + attrContainer;\n\t\t\t\t\t\tformdata = formdata ? formdata + \"&\" + queryContainer : queryContainer;\n\t\t\t\t\t}\n\t\t\t\t }\n\t\t\t } else if (trigger.url) {\n\t\t\t\t href = trigger.url;\n\t\t\t\t formdata = trigger.data;\n\t\t\t }\n\t\t}\n\n\t\tif (!(href = href || url)) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\t// get formdata\n\t\tformdata = formdata || params || \"\";\n\n\t\tif (typeof formdata == \"object\") {\n\t\t\tvar arrData = [];\n\t\t\tfor (key in formdata) {\n\t\t\t\tif (!formdata[key].forEach) {\n\t\t\t\t\tformdata[key] = [formdata[key]];\n\t\t\t\t}\n\t\t\t\tformdata[key].forEach(function(keyValue) {\n\t\t\t\t\tarrData.push(key + \"=\" + encodeURIComponent(keyValue));\n\t\t\t\t});\n\n\t\t\t}\n\t\t\tif (arrData.length > 0) {\n\t\t\t\tformdata = arrData.join(\"&\");\n\t\t\t} else {\n\t\t\t\tformdata = \"\";\n\t\t\t}\n\t\t}\n\n\t\t// get url of root\n\t\tcleanUrl = href.split(\"#\")[0].replace(/&+$/, \"\");\n\n\t\tif (cleanUrl.slice(-1) == \"?\") {\n\t\t\tcleanUrl = cleanUrl.split(\"?\")[0];\n\t\t}\n\t\t// url = root_url + joiner + formdata\n\t\tif (formdata != \"\") {\n\t\t\tif (/\\?/.test(cleanUrl)) {\n\t\t\t\tformdata = formdata.replace(/^&|\\?/, \"\");\n\t\t\t\tcleanUrl = cleanUrl + \"&\" + formdata;\n\t\t\t} else if (formdata != \"\") {\n\t\t\t\tformdata = formdata.replace(\"?\", \"\");\n\t\t\t\tcleanUrl = cleanUrl + \"?\" + formdata;\n\t\t\t}\n\t\t}\n\t\treturn cleanUrl;\n\t};\n\n\t/**\n\t * Create page according to given Dom-element or HTML string. And, notice!!!!! will do transition auto.\n\n\t * @params  domHtml:        dom-object|string. Create this to dom element as a role of into-page.               - Necessary\n\t            eleOrObj: dom-object|object. '.page element', or 'a element', or 'options' for get out-page   - Optional\n\t\t\t\toptions:            object.            basically, options = ajax options, of course, u can custom it!   - Optional\n\t * @returns undefined\n\t * @example Mobilebone.createPage(pageDom);\n\t            Mobilebone.createPage(generalDom);\n\t\t        Mobilebone.createPage('<div class=\"page out\">xxx</div>');\n\t\t        Mobilebone.createPage('<p>xxx</p>');\n\t\t        Mobilebone.createPage(pageDom, triggerLink);\n\t\t        Mobilebone.createPage(pageDom, { response: '<div...>' });\n\t\t        Mobilebone.createPage(pageDom, triggerLink, { response: '<div...>' });\n\t *\n\t**/\n\tMobilebone.createPage = function(domHtml, eleOrObj, options) {\n\t\tvar response = null, container = null, classPage = this.classPage, isreload = null;\n\t\t// 'eleOrObj' can '.page element', or 'a element', or 'options'\n\t\t// basically, options = ajax options, of course, u can custom it!\n\t\tif (!domHtml) return;\n\t\tif (typeof options == \"undefined\" && typeof eleOrObj == \"object\") {\n\t\t\toptions = eleOrObj;\n\t\t}\n\t\toptions = options || {};\n\n\t\t// 'options' that 'Mobilebone.transition()' needs\n\t\tvar optionsTransition = {};\n\n\t\t// get page-title from eleOrObj or options\n\t\tvar titlePage, idContainer, classPageInside;\n\n\t\tif (eleOrObj) {\n\t\t\tif (eleOrObj.nodeType == 1) {\n\t\t\t\t// legal elements\n\t\t\t\tif (eleOrObj.href || eleOrObj.action) {\n\t\t\t\t\ttitlePage = eleOrObj.getAttribute(\"data-title\") || options.title;\n\t\t\t\t}\n\t\t\t\tresponse = options.response;\n\t\t\t\tidContainer = eleOrObj.getAttribute(\"data-container\");\n\t\t\t\tcontainer = document.getElementById(idContainer);\n\t\t\t\tclassPageInside = eleOrObj.getAttribute(\"data-classpage\");\n\t\t\t\t// pass element as target params, add on v2.3.0\n\t\t\t\toptionsTransition.target = eleOrObj;\n\t\t\t\t// v2.4.4 is_root → isreload\n\t\t\t\tisreload = eleOrObj.getAttribute(\"data-reload\");\n\t\t\t\tif (eleOrObj.tagName.toLowerCase() == \"form\" || (isreload !== null && isreload != \"false\")) {\n\t\t\t\t\toptionsTransition.reload = true;\n\t\t\t\t}\n\t\t\t\t// v2.5.2\n\t\t\t\t// is back? for issues #128\n\t\t\t\toptionsTransition.back = eleOrObj.getAttribute(\"data-rel\") == \"back\";\n\n\t\t\t\t// v2.6.0 history\n\t\t\t\tif (eleOrObj.getAttribute(\"data-history\") == \"false\") {\n\t\t\t\t\toptionsTransition.history = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresponse = eleOrObj.response || options.response;\n\t\t\t\ttitlePage = eleOrObj.title || options.title;\n\t\t\t\tcontainer = eleOrObj.container || options.container;\n\t\t\t\tclassPageInside = eleOrObj.classPage || options.classPage;\n\t\t\t\toptionsTransition.target = eleOrObj.target;\n\t\t\t\t// v2.5.2\n\t\t\t\t// is back? for issues #128\n\t\t\t\toptionsTransition.back = eleOrObj.back || options.back;\n\t\t\t}\n\t\t\tif (container && classPageInside) {\n\t\t\t\tclassPage = classPageInside;\n\t\t\t}\n\t\t}\n\n\t\t// get current page(will be out) according to 'page_or_child'\n\t\tvar eleCurrentPage = (classPage == classPageInside? container : document).querySelector(\".in.\" + classPage);\n\n\t\t// get create page (will be into) according to 'domHtml'\n\t\tvar eleCreatePage = null;\n\n\t\tvar create = document.createElement(\"div\");\n\t\tif (typeof domHtml == \"string\") {\n\t\t\tcreate.innerHTML = domHtml;\n\t\t} else {\n\t\t\tcreate.appendChild(domHtml);\n\t\t}\n\n\t\t// excute inline JavaScript\n\t\tif (Mobilebone.evalScript == true && domHtml.firstintoBind != true) {\n\t\t\tslice.call(create.getElementsByTagName(\"script\")).forEach(function(originScript) {\n\t\t\t\tvar scriptContent = originScript.innerHTML.trim(), type = originScript.getAttribute(\"type\");\n\t\t\t\tif (scriptContent.trim() == \"\" || originScript.src) return;\n\t\t\t\tvar head = document.getElementsByTagName(\"head\")[0] || document.documentElement,\n\t\t\t\tscript = document.createElement(\"script\");\n\t\t\t\tif (type) script.type = type;\n\t\t\t\tscript.appendChild(document.createTextNode(scriptContent));\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\thead.insertBefore(script, head.firstChild);\n\t\t\t\t\thead.removeChild(script);\n\t\t\t\t\tscript = null;\n\t\t\t\t}, 17);\n\t\t\t\toriginScript = null;\n\t\t\t});\n\t\t}\n\n\t\tvar eleCreateTitle = create.getElementsByTagName(\"title\")[0];\n\n\t\t// get the page element\n\t\tif (!(eleCreatePage = create.querySelector(\".\" + classPage))) {\n\t\t\t// if there no .page, create as eleCreatePage\n\t\t\tcreate.className = classPage + \" out\";\n\t\t\teleCreatePage = create;\n\t\t}\n\t\t// set and store title\n\t\tif (typeof titlePage == \"string\") {\n\t\t\teleCreatePage.setAttribute(\"data-title\", titlePage);\n\t\t} else if (eleCreateTitle && eleCreateTitle.innerText) { // the judge behind '&&' for issues #144\n\t\t\teleCreatePage.setAttribute(\"data-title\", eleCreateTitle.innerText);\n\t\t}\n\n\t\t// do transition\n\t\toptionsTransition.response = response || domHtml;\n\t\toptionsTransition.id = this.getCleanUrl(eleOrObj) || eleCreatePage.id || options.id || options.url || (\"unique\" + Date.now());\n\n\t\t// 'if' statement below added on v2.0.0\n\t\tif (typeof options == \"object\") {\n\t\t\tif (typeof options.history != \"undefined\") {\n\t\t\t\toptionsTransition.history = options.history;\n\t\t\t}\n\t\t\tif (typeof options.remove != \"undefined\") {\n\t\t\t\toptionsTransition.remove = options.remove;\n\t\t\t}\n\t\t\tif (typeof options.target != \"undefined\") {\n\t\t\t\toptionsTransition.target = options.target;\n\t\t\t}\n\t\t\tif (typeof options.title != \"undefined\") {\n\t\t\t\toptionsTransition.title = options.title;\n\t\t\t}\n\t\t\t// add on v2.7.4\n\t\t\tif (typeof options.query != \"undefined\") {\n\t\t\t\toptionsTransition.query = options.query;\n\t\t\t}\n\t\t}\n\t\tif (classPage == classPageInside) {\n\t\t\toptionsTransition.history = false;\n\t\t\toptionsTransition.classPage = classPage;\n\t\t}\n\n\t\t// append to a accurate position\n\t\tcontainer = container || document.body;\n\n\t\t// remove page if have same id when optionsTransition.remove == true\n\t\tif (optionsTransition.remove == true && optionsTransition.id) {\n\t\t\tthis.remove(optionsTransition.id);\n\t\t}\n\t\t// 1. if new page, that insert create page as a last-child\n\t\t// 2. if replace a page, that insert before replaced page\n\t\tvar pageid = optionsTransition.id.split(\"?\")[0];\n\t\tif (pageid && store[pageid] && container.contains(store[pageid])) {\n\t\t\tcontainer.insertBefore(eleCreatePage, store[pageid]);\n\t\t} else {\n\t\t\tcontainer.appendChild(eleCreatePage);\n\t\t}\n\n\t\t// release memory\n\t\tcreate = null;\n\n\t\t// do transition\n\t\tthis.transition(eleCreatePage, eleCurrentPage, optionsTransition);\n\t};\n\n\t/**\n\t * For ajax callback.\n\t * For example, data-success=\"a.b.c\". We can't use 'a.b.c' as a function, because it's a string. We should do some work to get it!\n\n\t * @params  keys:        string. - Necessary\n\t * @returns function\n\t            undefined keys is not string\n\t\t\t\twindow    keys undefined\n\t * @example Mobilebone.getFunction(\"a.b.c\");\n\t *\n\t**/\n\tMobilebone.getFunction = function(keys) {\n\t\tif (typeof keys != \"string\") return;\n\t\t// eg. 'globalObject.functionName'\n\t\tvar fun = Mobilebone.rootTransition, arrKey = keys.split(\".\");\n\t\tfor (var index=0; index<arrKey.length; index+=1) {\n\t\t\tif (!(fun = fun[arrKey[index]])) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn fun;\n\t};\n\n\t/**\n\t * For ajax request to get HTML or JSON.\n\n\t * @params  aOrFormOrObj        - Necessary\n\t            1. dom-object:<a>|<form>.\n\t\t\t\t2. object.\n\t * @returns undefined\n\t * @example Mobilebone.ajax(document.querySelector(\"a\"));\n\t            Mobilebone.ajax({\n\t\t\t\t  url: 'xxx.html',\n\t\t\t\t  success: function() {}\n\t\t    \t});\n\t *\n\t**/\n\tMobilebone.ajax = function(aOrFormOrObj) {\n\t\tif (!aOrFormOrObj) return;\n\n\t\t// default params\n\t\tvar defaults = {\n\t\t\turl: \"\",\n\t\t\ttype: \"\",\n\t\t\tdataType: \"\",\n\t\t\tdata: {},\n\t\t\ttimeout: 10000,\n\t\t\tasync: true,\n\t\t\tusername: \"\",\n\t\t\tpassword: \"\",\n\t\t\tsuccess: function() {},\n\t\t\terror: function() {},\n\t\t\tcomplete: function() {}\n\t\t};\n\n\t\tvar params = {}, eleMask = null, formData = null;\n\n\t\t// classname of mask\n\t\tvar classMask = this.classMask;\n\n\t\t// if 'aOrFormOrObj' is a element, we should turn it to options-object\n\t\tvar paramsFromTrigger = {}, attrMask;\n\t\tif (aOrFormOrObj.nodeType == 1) {\n\t\t\tparamsFromTrigger = _queryToObject(aOrFormOrObj.getAttribute(\"data-params\") || \"\");\n\t\t\t// get params\n\t\t\tfor (key in defaults) {\n\t\t\t\t// data-* > data-params > defaults\n\t\t\t\tparams[key] = aOrFormOrObj.getAttribute(\"data-\" + key) || paramsFromTrigger[key] || defaults[key];\n\t\t\t\tif (typeof defaults[key] == \"function\" && typeof params[key] == \"string\") {\n\t\t\t\t\t// eg. globalObject.functionName\n\t\t\t\t\tparams[key] = this.getFunction(params[key]);\n\t\t\t\t\tif (typeof params[key] != \"function\") {\n\t\t\t\t\t\tparams[key] = defaults[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// address of ajax url\n\t\t\tparams.url = this.getCleanUrl(aOrFormOrObj, params.url);\n\n\t\t\tvar queryFromUrl = _queryToObject(params.url.split('?')[1]);\n\n\t\t\t// v2.7.4 fix params may ingore problem\n\t\t\tfor (var key in queryFromUrl) {\n\t\t\t\tif (typeof paramsFromTrigger[key] == 'undefined') {\n\t\t\t\t\tparamsFromTrigger[key] = queryFromUrl[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\t// v2.7.4\n\t\t\tparams.query = paramsFromTrigger;\n\t\t\t// store target\n\t\t\tparams.target = aOrFormOrObj;\n\t\t\t// v2.5.2\n\t\t\t// is back? for issues #128\n\t\t\tparams.back = aOrFormOrObj.getAttribute(\"data-rel\") == \"back\";\n\n\t\t\tvar tagName = aOrFormOrObj.tagName.toLowerCase();\n\t\t\tif (tagName == \"form\") {\n\t\t\t\tparams.type = aOrFormOrObj.method;\n\n\t\t\t\tformData = new FormData(aOrFormOrObj);\n\t\t\t} else if (tagName == \"a\") {\n\t\t\t\t// v2.5.8 for issues #157\n\t\t\t\tvar idContainer = aOrFormOrObj.getAttribute(\"data-container\"),\n\t\t\t\t\tclassPageInside = aOrFormOrObj.getAttribute(\"data-classpage\"),\n\t\t\t\t\tcontainer = idContainer && document.getElementById(idContainer);\n\t\t\t\tif (container && classPageInside && classPageInside != Mobilebone.classPage) {\n\t\t\t\t\t// inner ajax no history change\n\t\t\t\t\tparams.history = false;\n\t\t\t\t\t// title do not change\n\t\t\t\t\tparams.title = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// get mask element\n\t\t\tattrMask = aOrFormOrObj.getAttribute(\"data-mask\");\n\t\t\tif (attrMask == \"true\" || attrMask == \"\") {\n\t\t\t\teleMask = aOrFormOrObj.querySelector(\".\" + classMask);\n\t\t\t}\n\t\t}\n\t\t// if 'aOrFormOrObj' is a object\n\t\telse if (aOrFormOrObj.url) {\n\t\t\t// get params\n\t\t\tfor (key2 in defaults) {\n\t\t\t\tparams[key2] = aOrFormOrObj[key2] || defaults[key2];\n\t\t\t}\n\t\t\t// get url\n\t\t\tparams.url = this.getCleanUrl(null, params.url, params.data);\n\t\t\t// here params.title will become page title;\n\t\t\tparams.title = aOrFormOrObj.title;\n\t\t\t// v2.5.2\n\t\t\t// is back? for issues #128\n\t\t\t// when history.back()\n\t\t\tparams.back = aOrFormOrObj.back;\n\t\t\t// v2.6.1\n\t\t\tparams.container = aOrFormOrObj.container;\n\t\t\t// v2.7.4\n\t\t\tparams.query = _queryToObject(aOrFormOrObj.url.split('?')[1]);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\t// do ajax\n\t\t// get mask and loading element\n\t\tvar body = container || document.body;\n\t\tif (typeof attrMask != \"string\") {\n\t\t\teleMask = [].slice.call(body.children).filter(function (element) {\n\t\t\t\treturn element.classList.contains(classMask);\n\t\t\t})[0];\n\t\t}\n\n\t\tif (eleMask == null) {\n\t\t\teleMask = document.createElement(\"div\");\n\t\t\teleMask.className = classMask;\n\t\t\teleMask.innerHTML = '<i class=\"loading\"></i>';\n\t\t\tif (typeof attrMask == \"string\") {\n\t\t\t\taOrFormOrObj.appendChild(eleMask);\n\t\t\t} else {\n\t\t\t\tbody.appendChild(eleMask);\n\t\t\t}\n\t\t}\n\t\t// show loading\n\t\teleMask.style.display = \"inline\";\n\t\tif (this.showLoading) {\n\t\t\tthis.showLoading();\n\t\t}\n\n\t\t// ajax request\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.open(params.type || \"GET\", params.url + (/\\?/.test(params.url)? \"&\" : \"?\") + \"r=\" + Date.now(), params.async, params.username, params.password);\n\t\txhr.timeout = params.timeout;\n\n\t\txhr.onload = function() {\n\t\t\t// so far, many browser hasn't supported responseType = 'json', so, use JSON.parse instead\n\t\t\tvar response = null;\n\n\t\t\tif (xhr.status == 200) {\n\t\t\t\tif (params.dataType == \"json\" || params.dataType == \"JSON\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tresponse = JSON.parse(xhr.response);\n\t\t\t\t\t\tparams.response = response;\n\t\t\t\t\t\tMobilebone.createPage(Mobilebone.jsonHandle(response, params), aOrFormOrObj, params);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tparams.message = \"JSON parse error：\" + e.message;\n\t\t\t\t\t\tparams.error.call(params, xhr, xhr.status);\n\t\t\t\t\t}\n\t\t\t\t} else if (params.dataType == \"unknown\") {\n\t\t\t\t\t// ajax send by url\n\t\t\t\t\t// no history hush\n\t\t\t\t\tparams.history = false;\n\t\t\t\t\t// I don't remember why add 'params.remove = false' here,\n\t\t\t\t\t// but it seems that this will cause issues #147\n\t\t\t\t\t// no element remove\n\t\t\t\t\t// del → v2.5.8 // params.remove = false;\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// as json\n\t\t\t\t\t\tresponse = JSON.parse(xhr.response);\n\t\t\t\t\t\tparams.response = response;\n\t\t\t\t\t\tMobilebone.createPage(Mobilebone.jsonHandle(response, params), aOrFormOrObj, params);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// as html\n\t\t\t\t\t\tresponse = xhr.response;\n\t\t\t\t\t\tMobilebone.createPage(response, aOrFormOrObj, params);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresponse = xhr.response;\n\t\t\t\t\t// 'response' is string\n\t\t\t\t\tMobilebone.createPage(response, aOrFormOrObj, params);\n\t\t\t\t}\n\t\t\t\tparams.success.call(params, response, xhr.status);\n\t\t\t} else {\n\t\t\t\tparams.message = \"The status code exception!\";\n\t\t\t\tparams.error.call(params, xhr, xhr.status);\n\t\t\t}\n\n\t\t\tparams.complete.call(params, xhr, xhr.status);\n\n\t\t\t// hide loading\n\t\t\teleMask.style.display = \"none\";\n\t\t\tif (this.hideLoading) {\n\t\t\t\tthis.hideLoading();\n\t\t\t}\n\t\t}\n\n\t\txhr.onerror = function(e) {\n\t\t\tparams.message = \"Illegal request address or an unexpected network error!\";\n\t\t\tparams.error.call(params, xhr, xhr.status);\n\t\t\t// hide loading\n\t\t\teleMask.style.display = \"none\";\n\t\t\tif (this.hideLoading) {\n\t\t\t\tthis.hideLoading();\n\t\t\t}\n\t\t}\n\n\t\txhr.ontimeout = function() {\n\t\t\tparams.message = \"The request timeout!\";\n\t\t\tparams.error.call(params, xhr, xhr.status);\n\t\t\t// hide loading\n\t\t\teleMask.style.display = \"none\";\n\t\t\tif (this.hideLoading) {\n\t\t\t\tthis.hideLoading();\n\t\t\t}\n\t\t};\n\n\t\t// set request header for server\n\t\txhr.setRequestHeader(\"Type\", \"ajax\");\n\t\txhr.setRequestHeader(\"From\", \"mobilebone\");\n\n\t\txhr.send(formData);\n\t};\n\n\t/**\n\t * capture form submit events to a ajax request.\n\n\t * @params  form:        formElement. - Necessary\n\t * @example Mobilebone.form(document.querySelector(\"form\"));\n\t *\n\t**/\n\tMobilebone.submit = function(form) {\n\t\tif (!form || typeof form.action != \"string\") {\n\t\t\treturn;\n\t\t}\n\t\tvar ajax = form.getAttribute(\"data-ajax\");\n\t\tif (ajax == \"false\" || (Mobilebone.captureForm == false && ajax != \"true\")) return;\n\n\t\tform.addEventListener(\"submit\", function(event) {\n\t\t\t// prevent detect\n\t\t\tvar attrPrevent = this.getAttribute(\"data-preventdefault\");\n\t\t\t// get 'preventDefault' function\n\t\t\tvar funPrevent = Mobilebone.getFunction(attrPrevent);\n\t\t\tif (typeof funPrevent == \"function\" && funPrevent(this) == true) {\n\t\t\t\t// if the return value of prevent function is true, prevent everything~\n\t\t\t\tevent.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tMobilebone.ajax(this);\n\t\t\tevent.preventDefault();\n\t\t});\n\t};\n\n\n\t/**\n\t * Sometime we don't know direction of transition. Such as browser history change, or data-rel=\"auto\".\n\t   In this case, we ensure the direction(back or prev) by the sorts of two pages(into or out)\n\n\t * @params  pageIn  dom-object      - Necessary\n\t            pageOut  dom-object      - Optional\n\n\t * @returns boolean\n\t *\n\t**/\n\tMobilebone.isBack = function(pageIn, pageOut) {\n\t\t// back or forword, according to the order of two pages\n\t\tif (history.tempBack == true) {\n\t\t\t// backwords\n\t\t\thistory.tempBack = null;\n\t\t\treturn true;\n\t\t}\n\t\tif (typeof pageIn == \"undefined\") return true;\n\t\tif (!pageOut) return false;\n\t\treturn pageIn.compareDocumentPosition(pageOut) == 4;\n\t};\n\n\t/**\n\t * If dataType of ajax is 'json', we can't convert json-data to page-element.\n\t   So, we export a function names 'jsonHandle' to handle json-data.\n\t * Attention, it's a global interface. If your project has many json call, you should use JSON itself to make a distinction.\n\t   For example, every JSON include the only json-id:\n\t   {\n\t\t  \"id\": \"homePage\" ,\n\t\t  \"data\": []\n\t   }\n\t   different with\n\t   {\n\t\t  \"id\": \"listPage\" ,\n\t\t  \"data\": []\n\t   }\n\t *\n\t * @params  json    - Necessary\n\t * @returns dom-object|string\n\t *\n\t**/\n\tMobilebone.jsonHandle = function(json, params) {\n\t\treturn '<p style=\"text-align:center;\">Dear master, if you see me, show that JSON parsing function is undefined!</p>';\n\t},\n\n\t/**\n\t * Initialization. Load page according to location.hash. And bind link-catch events.\n\t**/\n\tMobilebone.init = function() {\n\t\tif (hasInited == true) return 'Don\\'t repeat initialization!';\n\n\t\tvar hash = location.hash.replace(\"#&\", \"#\"), eleIn = null, container = null;\n\t\t// 查询和根处理\n\t\tvar key = hash.split(\"?\")[0];\n\t\tvar query = hash.split(\"?\")[1];\n\n\t\tvar options = {\n\t    \tquery: {}\n\t    };\n\t    if (query) {\n\t    \toptions.query = _queryToObject(query);\n\t    }\n\n\t\tif (key == \"\" || key == \"#\") {\n\t\t\tthis.transition(document.querySelector(\".\" + this.classPage));\n\t\t} else if (isSimple.test(key) == true && (eleIn = document.querySelector(key)) && eleIn.classList.contains(this.classPage)) {\n\t\t    // add on v2.7.4 pure inner hash also support query params\n\t\t    // eg. #somePageId?id=1&type=2\n\t\t    options.id = hash.replace(/^#/, \"\");\n\n\t\t\tthis.transition(eleIn, null, options);\n\t\t} else {\n\t\t\t// add on v2.6.1\n\t\t\tif (hash.split(\"container=\").length == 2) {\n\t\t\t\tcontainer = document.getElementById(hash.split(\"container=\")[1].split(\"&\")[0]);\n\t\t\t}\n\t\t\t// as a ajax\n\t\t\tthis.ajax({\n\t\t\t\turl: hash.replace(\"#\", \"\"),\n\t\t\t\tdataType: \"unknown\",\n\t\t\t\tcontainer: container,\n\t\t\t\terror: function() {\n\t\t\t\t\t// add on v2.7.4\n\t\t\t\t\toptions.id = hash.replace(/^#/, \"\");\n\n\t\t\t\t\teleIn = document.querySelector(\".\" + Mobilebone.classPage);\n\t\t\t\t\tMobilebone.transition(eleIn, null, options);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Initialization link-catch events.\n\t\tvar $ = root.$ || root.jQuery || root.Zepto;\n\t\tif ($ && $.fn && $.fn.tap && ('ontouchstart' in window == true)) {\n\t\t\t// for some unknown 'tap' plugin\n\t\t\t$(document).tap(this.handleTapEvent);\n\n\t\t\t// zepto tap event.preventDefault can't prevent default click-events\n\t\t\tdocument.addEventListener(\"click\", function(event) {\n\t\t\t\tvar target = event.target;\n\t\t\t\tif (!target) return;\n\t\t\t\tif (target.tagName.toLowerCase() != \"a\" && !(target = target.getParentElementByTag(\"a\"))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar ajax = target.getAttribute(\"data-ajax\"), href = target.href;\n\t\t\t\t// if not ajax request\n\t\t\t\tif (target.getAttribute(\"data-rel\") == \"external\"\n\t\t\t\t\t|| ajax == \"false\"\n\t\t\t\t\t|| (href.replace(\"://\", \"\").split(\"/\")[0] !== location.href.replace(\"://\", \"\").split(\"/\")[0] && ajax != \"true\")\n\t\t\t\t\t|| (Mobilebone.captureLink == false && ajax != \"true\")\n\t\t\t\t) {\n\t\t\t\t\t// issues #123 #137 #142\n\t\t\t\t\tif (/^http/i.test(href)) location.href = href;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\t\t} else {\n\t\t\tdocument.addEventListener(\"click\", this.handleTapEvent);\n\t\t}\n\n\t\t// Important:\n\t\t// In ios7+, swipe the edge of page will navigate Safari\n\t\t// that will trigger 'popstate' events and the page will transition twice\n\t\tvar isSafari7 = !!navigator.userAgent.match(/safari/i) && !navigator.userAgent.match(/chrome/i) && typeof document.hidden !== \"undefined\" && !window.chrome;\n\t\tif ('ontouchstart' in window == true && isSafari7) {\n\t\t\tdocument.addEventListener(\"touchmove\", function() {\n\t\t\t\thistory.popstateswipe = true;\n\t\t\t});\n\t\t\tdocument.addEventListener(\"touchend\", function() {\n\t\t\t\thistory.popstateswipe = false;\n\t\t\t});\n\t\t}\n\n\t\t// change flag-var for avoiding repeat init\n\t\thasInited = true;\n\t};\n\n\t/**\n\t * If 'a' element has href, slide auto when tapping~\n\t**/\n\tMobilebone.handleTapEvent = function(event) {\n\t\t/**\n\t\t// iscroll(set tap: true) may cause twice tap problem\n\t\t// which is none of Mobilebone's business\n\t\t// However, you can let code below go to avoid twice tap in Mobilebone\n\t\t// but the tap event bind out of Mobilebone also has bug\n\t\t// so my advice is that:\n\t\t// 1. use Date.now to judge as Mobilebone did;\n\t\t// or\n\t\t// 2. keep this code in the form of comment and fixed bug outside\n\t\tif (store.timerTap && Date.now() - store.timerTap < 100) {\n\t\t\tevent.preventDefault();\n\t\t\treturn false;\n\t\t}\n\t\tstore.timerTap = Date.now();\n\t\t*/\n\t\tvar target = null;\n\t\t// you can pass target as params directly\n\t\tif (event && event.nodeType == 1) {\n\t\t\ttarget = event;\n\t\t\ttarget.preventDefault = function() {};\n\t\t}\n\t\t// get target and href\n\t\ttarget = target || event.target || event.touches[0];\n\t\tvar href = target.href;\n\t\tif ((!href || /a/i.test(target.tagName) == false) && (target = target.getParentElementByTag(\"a\"))) {\n\t\t\thref = target.href;\n\t\t}\n\t\t// the page that current touched or actived\n\t\tvar selfPage = document.querySelector(\".in.\" + Mobilebone.classPage);\n\n\t\tif (selfPage == null || !target) {\n\t\t\treturn;\n\t\t}\n\n\t\t// optional params for Mobilebone.transition\n\t\tvar options = {\n\t\t\ttarget: target\n\t\t};\n\n\t\t// prevent detect\n\t\tvar attrPrevent = target.getAttribute(\"data-preventdefault\")\n\t\t\t|| _queryToObject(target.getAttribute(\"data-params\") || \"\").preventdefault;\n\t\t// get 'preventDefault' function\n\t\tvar funPrevent = Mobilebone.getFunction(attrPrevent);\n\t\tif (typeof funPrevent == \"function\" && funPrevent(target) == true) {\n\t\t\t// if the return value of prevent function is true, prevent everything~\n\t\t\tevent.preventDefault();\n\t\t\treturn false;\n\t\t}\n\n\t\t// if mask element exist and displaying, prevent double trigger\n\t\tvar eleMask = target.getElementsByClassName(Mobilebone.classMask)[0];\n\t\tif (eleMask && eleMask.style.display != \"none\") {\n\t\t\tevent.preventDefault();\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idContainer = target.getAttribute(\"data-container\"),\n\t\t\tclassPageInside = target.getAttribute(\"data-classpage\");\n\t\tvar container = idContainer && document.getElementById(idContainer);\n\t\tif (container && classPageInside && classPageInside != Mobilebone.classPage) {\n\t\t\tselfPage = container.querySelector(\".in.\" + classPageInside) || container.querySelector(classPageInside);\n\t\t\t// if (selfPage == null) return false;\n\t\t\toptions.history = false;\n\t\t\toptions.title = false;\n\t\t\toptions.classPage = classPageInside;\n\t\t}\n\n\t\t// history\n\t\tif (target.getAttribute(\"data-history\") == \"false\") {\n\t\t\toptions.history = false;\n\t\t}\n\n\t\t// if captureLink\n\t\tvar capture = (Mobilebone.captureLink == true);\n\t\t// get rel\n\t\tvar rel = target.getAttribute(\"data-rel\");\n\t\t// if back\n\t\tvar back = false;\n\t\tif (rel == \"back\") {\n\t\t\tback = true;\n\t\t}\n\n\t\t// if external link\n\t\tvar external = (rel == \"external\");\n\n\t\t// if the 'href' is not legal, return\n\t\t// include:\n\t\t// 1. undefined\n\t\t// 2. javascript: (except data-rel=\"back\")\n\t\t// 3. cros, or not capture (except data-ajax=\"true\")\n\t\tif (!href) return;\n\n\t\thref = href.replace(\"#&\", \"#\");\n\n\t\tif (target.getAttribute(\"href\").replace(/#/g, \"\") === \"\") {\n\t\t\tevent.preventDefault();\n\t\t\treturn;\n\t\t}\n\t\tif (/^javascript/.test(href)) {\n\t\t\tif (back == false) return;\n\t\t} else {\n\t\t\texternal = external || (href.replace(\"://\", \"\").split(\"/\")[0] !== location.href.replace(\"://\", \"\").split(\"/\")[0]);\n\t\t\tif ((external == true || capture == false) && target.getAttribute(\"data-ajax\") != \"true\") return;\n\t\t}\n\n\t\tvar attrHref = target.getAttribute(\"href\");\n\n\t\t// judge that if it's a ajax request\n\t\tif (/^#/.test(attrHref) == true) {\n\t\t\t// hash slide\n\t\t\tvar hashTargetPage = href.split(\"#\")[1];\n\t\t\tvar idTargetPage = hashTargetPage.split(\"?\")[0];\n\t\t\tvar queryTargetPage = hashTargetPage.split(\"?\")[1];\n\t\t\t// add on v2.7.4\n\t\t\toptions.query = _queryToObject(queryTargetPage);\n\t\t\toptions.id = hashTargetPage;\n\n\t\t\tvar eleTargetPage = idTargetPage && document.getElementById(idTargetPage);\n\t\t\tif (back == false && rel == \"auto\") {\n\t\t\t\tback = Mobilebone.isBack(eleTargetPage, selfPage);\n\t\t\t}\n\n\t\t\tif (eleTargetPage) {\n\t\t\t\tMobilebone.transition(eleTargetPage, selfPage, back, options);\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t} else if (/^javascript/.test(href)) {\n\t\t\t// back\n\t\t\thistory.tempBack = true;\n\t\t\thistory.back();\n\t\t} else if (target.getAttribute(\"data-ajax\") != \"false\") {\n\t\t\t// get a clean ajax url as page id\n\t\t\tvar cleanUrl = Mobilebone.getCleanUrl(target);\n\t\t\t// add on v2.7.4\n\t\t\toptions.query = _queryToObject(cleanUrl.split(\"?\")[1]);\n\t\t\t// if has loaded and the value of 'data-reload' is not 'true'\n\t\t\tvar attrReload = target.getAttribute(\"data-reload\");\n\n\n\t\t\tif ((attrReload == null || attrReload == \"false\") && store[cleanUrl]) {\n\t\t\t\tif (back == false && rel == \"auto\") {\n\t\t\t\t\tback = Mobilebone.isBack(store[cleanUrl], selfPage);\n\t\t\t\t}\n\t\t\t\toptions.id = cleanUrl;\n\n\t\t\t\tvar body = container || document.body;\n\n\t\t\t\tif (body.contains(store[cleanUrl]) == false) {\n\t\t\t\t\tbody.appendChild(store[cleanUrl]);\n\t\t\t\t}\n\t\t\t\tMobilebone.transition(store[cleanUrl], selfPage, back, options);\n\t\t\t} else {\n\t\t\t\t// v2.7.0 move to here\n\t\t\t\tif (typeof attrReload == \"string\" && attrReload != \"false\") {\n\t\t\t\t\tif (attrReload != \"\" && attrReload != \"true\") {\n\t\t\t\t\t\t// v2.7.2 a new method to remove pafe\n\t\t\t\t\t\t// think 'attrReload' as special ID\n\t\t\t\t\t\t// remove all page using this ID\n\t\t\t\t\t\tslice.call(document.querySelectorAll('a[data-reload=\"'+ attrReload +'\"]')).forEach(function (ele) {\n\t\t\t\t\t\t\tMobilebone.remove(ele);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// remove page\n\t\t\t\t\t\tMobilebone.remove(store[cleanUrl]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// as ajax\n\t\t\t\tMobilebone.ajax(target);\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t}\n\t};\n\n\n\t/**\n\t * prototype extend method: get parent element by tagName\n\t**/\n\tElement.prototype.getParentElementByTag = function(tag) {\n\t\tif (!tag) return null;\n\t\tvar element = null, parent = this;\n\t\tvar popup = function() {\n\t\t\tparent = parent.parentElement;\n\t\t\tif (!parent) return null;\n\t\t\tvar tagParent = parent.tagName.toLowerCase();\n\t\t\tif (tagParent === tag) {\n\t\t\t\telement = parent;\n\t\t\t} else if (tagParent == \"body\") {\n\t\t\t\telement = null;\n\t\t\t} else {\n\t\t\t\tpopup();\n\t\t\t}\n\t\t};\n\t\tpopup();\n\t\treturn element;\n\t};\n\n\t/**\n\t * private method: convert query string to key-value object\n\t**/\n\tvar _queryToObject = function(string) {\n\t\tvar obj = {};\n\t\tif (typeof string == \"string\") {\n\t\t\tstring.split(\"&\").forEach(function(part) {\n\t\t\t\tvar arrPart = part.split(\"=\");\n\t\t\t\tif (arrPart.length > 1) {\n\t\t\t\t\tobj[arrPart[0]] = part.replace(arrPart[0] + \"=\", \"\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn obj;\n\t};\n\n\t/**\n\t * auto init\n\t**/\n\twindow.addEventListener(\"DOMContentLoaded\", function() {\n\t\tif (hasInited == false) {\n\t\t\tMobilebone.init();\n\t\t}\n\t});\n\n\t/**\n\t * page change when history change\n\t**/\n\twindow.addEventListener(\"popstate\", function() {\n\t\tif (history.popstateswipe == true) {\n\t\t\tlocation.reload();\n\t\t\thistory.popstateswipe = false;\n\t\t\treturn;\n\t\t}\n\t\tif (history.popstate == false) {\n\t\t\thistory.popstate = true;\n\t\t\treturn;\n\t\t}\n\n\t\tvar hash = location.hash.replace(\"#&\", \"#\").replace(/^#/, \"\");\n\t\t// add on v2.7.4\n\t\tvar key = hash.split('?')[0];\n\t\tvar pageIn = null\n\t\t// add on v2.6.1\n\t\tvar container = null;\n\n\t\tif (hash == \"\") {\n\t\t\t// if no hash, get first page as 'pageIn'\n\t\t\tpageIn = document.querySelector(\".\" + Mobilebone.classPage);\n\t\t\tif (pageIn.id) return;\n\t\t} else {\n\t\t\t// add on v2.7.4\n\t\t\tpageIn = store[key] || store[hash];\n\n\t\t\t// add on v2.6.1\n\t\t\tif (hash.split(\"container=\").length == 2) {\n\t\t\t\tcontainer = document.getElementById(hash.split(\"container=\")[1].split(\"&\")[0]);\n\t\t\t}\n\n\t\t\tif (pageIn && isSimple.test(key) == false) {\n\t\t\t\t// just transition\n\t\t\t\tMobilebone.transition(pageIn, document.querySelector(\".in.\" + Mobilebone.classPage), true, {\n\t\t\t\t\tid: hash,  // fix issue #83\n\t\t\t\t\thistory: false,\n\t\t\t\t\tcontainer: container,\n\t\t\t\t\tquery: _queryToObject(hash.split('?')[1])\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (!pageIn) {\n\t\t\tif (isSimple.test(hash) == false) {\n\t\t\t\t// as a url\n\t\t\t\tMobilebone.ajax({\n\t\t\t\t\turl: hash,\n\t\t\t\t\tdataType: \"unknown\",\n\t\t\t\t\tback: Mobilebone.isBack(),\n\t\t\t\t\tcontainer: container\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpageIn = document.querySelector(\"#\" + key) || document.querySelector(\"#\" + hash);\n\t\t}\n\n\t\tvar pageOut = document.querySelector(\".in.\" + Mobilebone.classPage);\n\n\t\tif ((pageIn && pageIn == pageOut) || Mobilebone.pushStateEnabled == false) return;\n\n\t\t// hash ↔ id\n\t\tif (pageIn) {\n\t\t\tMobilebone.transition(pageIn, pageOut, Mobilebone.isBack(pageIn, pageOut), {\n\t\t\t\tid: hash,  // fix issue #83\n\t\t\t\thistory: false,\n\t\t\t\tquery: _queryToObject(hash.split('?')[1])\n\t\t\t});\n\t\t}\n\t});\n\n\tdocument.MBLOADED = true;\n\n\treturn Mobilebone;\n});"]}